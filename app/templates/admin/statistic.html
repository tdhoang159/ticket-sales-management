{% extends 'admin/master.html' %}
{% block body %}
<h2>üìä Th·ªëng k√™ Doanh thu & V√© b√°n</h2>

<form method="get" class="form-inline mb-3">

    <!-- Filter theo th·ªùi gian -->
    <label class="mr-2">Th·ªëng k√™:</label>
    <select name="time_type" class="form-control mr-2" onchange="this.form.submit()">
        <option value="month" {{
        'selected' if time_type == 'month' }}>Theo th√°ng</option>
        <option value="quarter" {{
        'selected' if time_type == 'quarter' }}>Theo qu√Ω</option>
        <option value="year" {{
        'selected' if time_type == 'year' }}>Theo nƒÉm</option>
    </select>

    <input type="number" name="time_value" class="form-control mr-2"
           placeholder="Nh·∫≠p s·ªë {{ time_type }}"
           value="{{ time_value if time_value else '' }}"/>

    <!-- Filter theo Organizer -->
    <label class="mr-2">Organizer:</label>
    <select name="organizer_id" class="form-control mr-2" onchange="this.form.submit()">
        <option value="">T·∫•t c·∫£</option>
        {% for org in organizers %}
        <option value="{{ org.id }}" {{'selected' if organizer_id|string == org.id|string else '' }}>{{ org.company_name }}</option>
        {% endfor %}
    </select>

    <button type="submit" class="btn btn-primary">L·ªçc</button>
</form>

<table class="table table-bordered table-striped">
    <thead>
    <tr>
        <th>Organizer</th>
        <th>S·ª± ki·ªán</th>
        <th>V√© VIP</th>
        <th>V√© th∆∞·ªùng</th>
        <th>T·ªïng doanh thu (VNƒê)</th>
    </tr>
    </thead>
    <tbody>
    {% for row in stats %}
    <tr>
        <td>{{ row.organizer }}</td>
        <td>{{ row.event }}</td>
        <td>{{ row.vip_tickets }}</td>
        <td>{{ row.normal_tickets }}</td>
        <td>{{ "{:,.0f}".format(row.revenue or 0) }}</td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% endblock %}